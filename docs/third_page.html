<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>thirdpage - ëª¨ì´ìƒˆ ì•½ì† ì¡ê¸°</title>
  
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="container">
    <header>
      <h1 id="meeting-title"></h1>
    </header>

    <section class="input-section">
      <form id="availabilityForm">
        <!-- 1) ì´ë¦„ -->
        <input type="text" id="name" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" required />

        <!-- 2) ì‹œê°„ ì„ íƒ: ì‹œì‘ -->
        <div class="time-picker-inline">
          <label for="startHour">ì‹œì‘ ì‹œê°„:</label>
          <div class="time-select-group">
            <select id="startHour" required></select> :
            <select id="startMinute" required></select>
          </div>
        </div>

        <!-- 3) ì‹œê°„ ì„ íƒ: ì¢…ë£Œ -->
        <div class="time-picker-inline">
          <label for="endHour">ì¢…ë£Œ ì‹œê°„:</label>
          <div class="time-select-group">
            <select id="endHour" required></select> :
            <select id="endMinute" required></select>
          </div>
        </div>

        <!-- 4) ë‚ ì§œ ì„ íƒ -->
        <select id="date" required></select>

        <!-- 5) í™•ì‹¤ì„± -->
        <select id="certainty">
          <option value="definite">í™•ì‹¤í•¨</option>
          <option value="maybe">ê°€ëŠ¥ì„± ìˆìŒ</option>
        </select>

        <button type="submit">ì‹œê°„ ë“±ë¡</button>
      </form>
      <button id="goResultBtn" style="margin-top:.5rem;">ê²°ê³¼ í™”ë©´ ì—´ê¸°</button>
    </section>

    <!-- ì˜ê²¬ ë©”ëª¨ì¥ -->
    <!-- ì˜ê²¬ ë©”ëª¨ì¥ (ì™¼ìª½ í•˜ë‹¨ ê³ ì •) -->
    <section class="memo-section"
            style="position:fixed; bottom:1rem; left:1rem;
                    width:280px; padding:1rem; background:#fff5e1;
                    border:2px solid #a7904d; border-radius:12px;
                    box-shadow:0 2px 6px rgba(0,0,0,0.15);
                    z-index:1000;">
      <h3 style="margin-top:0;">ğŸ“Œ ì˜ê²¬ ë©”ëª¨</h3>
      <textarea id="memoInput" placeholder="ì•½ì†ì— ëŒ€í•´ ììœ ë¡­ê²Œ ì˜ê²¬ì„ ë‚¨ê²¨ì£¼ì„¸ìš”..."
                style="width:100%; height:80px; margin-bottom:0.5rem;
                      padding:0.5rem; border-radius:8px; border:1px solid #ccc;"></textarea>
      <button id="saveMemoBtn"
              style="background-color:#a7904d; color:white;
                    padding:0.5rem 1rem; border:none; border-radius:8px;
                    cursor:pointer; margin-bottom:0.5rem;">ë©”ëª¨ ì €ì¥</button>
      <ul id="memoList"
          style="list-style:none; padding:0; max-height:150px;
                overflow-y:auto; font-size:0.9rem;">
      </ul>
    </section>

    
    <!-- â–¼ ìŠ¤ì¼€ì¤„ ì˜ì—­: JSê°€ ë™ì  ìƒì„±í•©ë‹ˆë‹¤ â–¼ -->
    <section class="schedule"></section>

    <!-- ê³ ì • í‘œì‹œ íŒ¨ë„ -->
    <section id="meeting-info"
             style="position:fixed; bottom:1rem; right:1rem;
                    width:280px; padding:1rem; background:#fff;
                    border:1px solid #ccc; border-radius:8px;
                    box-shadow:0 2px 6px rgba(0,0,0,0.15);
                    z-index:1000;">
      <h2 id="meeting-name" style="margin-bottom:0.5rem;"></h2>
      <p id="meeting-location" style="margin-bottom:0.5rem;"></p>
      <a id="meeting-link" href="#" target="_blank"></a>
    </section>
  </div>

  <!-- Firebase SDK ë° ì„¤ì • -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCiVW_fvG5hXmt_6aMeDRwXVU19ByRO1iA",
      authDomain: "moysay-d2606.firebaseapp.com",
      databaseURL: "https://moysay-d2606-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "moysay-d2606",
      storageBucket: "moysay-d2606.appspot.com",
      messagingSenderId: "843998694219",
      appId: "1:843998694219:web:219ec5ebdbf835c08076ce"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    //const memoRef = ref(db, 'memos');
    // roomNameì„ localStorageì—ì„œ ì½ì–´ì™€ì„œ ë°©ë³„ ê²½ë¡œë¡œ ì €ì¥/ì¡°íšŒ
    const meetingInfo = JSON.parse(localStorage.getItem('meetingInfo')) || {};
    const roomName = meetingInfo.name || 'default-room';
    const memoRef = ref(db, `rooms/${roomName}/memos`);

    // DOMì´ ì¤€ë¹„ë˜ë©´ ì‹¤í–‰
    window.addEventListener("DOMContentLoaded", () => {
      // ë©”ëª¨ ì €ì¥
      document.getElementById("saveMemoBtn").addEventListener("click", () => {
        const content = document.getElementById("memoInput").value.trim();
        const name = document.getElementById("name").value || "ìµëª…";

        if (content === "") return;

        push(memoRef, {
          name,
          content,
          timestamp: new Date().toISOString()
        });

        document.getElementById("memoInput").value = "";
      });

      // ë©”ëª¨ ë¶ˆëŸ¬ì˜¤ê¸°
      onValue(memoRef, (snapshot) => {
        const memoList = document.getElementById("memoList");
        memoList.innerHTML = "";

        snapshot.forEach((child) => {
          const { name, content } = child.val();
          const li = document.createElement("li");
          li.textContent = `[${name}] ${content}`;
          memoList.appendChild(li);
        });
      });
    });

    // ë‹¤ë¥¸ ìŠ¤í¬ë¦½íŠ¸ì—ì„œë„ ì“¸ ìˆ˜ ìˆê²Œ ë“±ë¡ (ì„ íƒ ì‚¬í•­)
    window.firebaseDB = db;
    window.firebaseRef = ref;
    window.firebasePush = push;
    window.firebaseOnValue = onValue;
  </script>


  <!-- ê¸°ì¡´ ìŠ¤í¬ë¦½íŠ¸: Firebase ì—°ë™ ë° UI ì—…ë°ì´íŠ¸ í¬í•¨ -->
  <script src="script.js"></script>
</body>
</html>